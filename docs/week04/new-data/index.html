<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Refactor to Allow for New Data! &#8212; LaunchCode: GIS DevOps  documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/fa/css/all.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/launchcode.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/lc-ed-logo.png" alt="LaunchCode logo"></span>
          GIS DevOps</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Pages <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day1/index.html">Week 1 - Day 1: Git, GitLab, IntelliJ, Refactoring, Unit Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day1/index.html#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day1/index.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day1/index.html#slides">Slides</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day1/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day1/index.html#exercises">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day1/index.html#studio">Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day1/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day2/index.html">Week 1 - Day 2: Security, Test-driven development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day2/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day2/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day2/index.html#studio">Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day2/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day3/index.html">Week 1 - Day 3: Integration testing, dependency injection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day3/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day3/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day3/index.html#studio">Studio</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day4/index.html">Week 1 - Day 4: Postgres, Spring Data, JPA, Hibernate</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day4/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day4/index.html#walkthroughs">Walkthroughs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day4/index.html#studio">Studio</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day5/index.html">Week 1 - Day 5: AJAX, Open Layers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day5/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day5/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day5/index.html#studio">Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day5/index.html#retro">Retro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day5/index.html#additional-resources">Additional Resources</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../week02/project/index.html">Week 2 - Project Week: Zika Mission Control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week02/project/index.html#zika-mission-control">Zika Mission Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week02/project/index.html#project-overview">Project Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week02/project/index.html#project-requirements">Project Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week02/project/index.html#primary-objectives">Primary Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week02/project/index.html#secondary-objectives">Secondary Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week02/project/index.html#turning-in-your-work">Turning in Your Work</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week02/project/index.html#check-your-knowledge">Check Your Knowledge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week02/project/index.html#bonus-resources">Bonus Resources</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day1/index.html">Week 3 - Day 1: RESTful web services</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day1/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day1/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day1/index.html#studio">Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day1/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day2/index.html">Week 3 - Day 2 Swagger REST framework</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day2/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day2/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day2/index.html#studio">Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day2/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day3/index.html">Week 3 - Day 3: Intro to Elasticsearch</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day3/index.html#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day3/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day3/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day3/index.html#studio">Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day3/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day4/index.html">Week 3 - Day 4: More Elasticsearch, Integrating ES with Spring</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day4/index.html#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day4/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day4/index.html#walkthroughs">Walkthroughs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day4/index.html#studio">Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day4/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day5/index.html">Week 3 - Day 5: ES2015, ESLint, OpenLayers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day5/index.html#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day5/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day5/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day5/index.html#studio">Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day5/index.html#retro">Retro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day5/index.html#resources">Resources</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../project/index.html">Week 4 - Project Week: Zika Mission Control Part 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../project/index.html#project-requirements">Project Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../project/index.html#primary-objectives">Primary Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../project/index.html#secondary-objectives">Secondary Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../project/index.html#turning-in-your-work">Turning in Your Work</a></li>
<li class="toctree-l2"><a class="reference internal" href="../project/index.html#check-your-knowledge">Check Your Knowledge</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../week05/day1/index.html">Week 5 - Day 1: Intro to DevOps/AWS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day1/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day1/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day1/index.html#studio">Studio</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week05/day2/index.html">Week 5 - Day 2: More with AWS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day2/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day2/index.html#studio">Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day2/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week05/day3/index.html">Week 5 - Day 3: 12 Factor Apps and Auto Scaling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day3/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day3/index.html#studio">Studio</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week05/day4/index.html">Week 5 - Day 4: Gradle, Continuous Integration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day4/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day4/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day4/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week05/day5/index.html">Week 5 - Day 5: Sonarqube</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day5/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day5/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day5/index.html#retro">Retro</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../week06/project/index.html">Week 6 - Project Week: Zika Mission Control Part 3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week06/project/index.html#project-requirements">Project Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week06/project/index.html#primary-objectives">Primary Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week06/project/index.html#secondary-objectives">Secondary Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week06/project/index.html#turning-in-your-work">Turning in Your Work</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week06/project/index.html#check-your-knowledge">Check Your Knowledge</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../week08/project/index.html">Week 8 - Project Week: Zika Mission Control Part 4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week08/project/index.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week08/project/index.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week08/project/index.html#normalizing-data">Normalizing Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week08/project/index.html#setup">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week08/project/index.html#integrating-geoserver">Integrating GeoServer</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../week09/day3/index.html">Week 9 - Day 3: Intro to Docker</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day3/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day3/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day3/index.html#studio">Studio</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week09/day4/index.html">Week 9 - Day 4: OAuth2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day4/index.html#lesson">Lesson</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day4/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week09/day5/index.html">Week 9 - Day 5: Certificates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day5/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day5/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day5/index.html#resources">Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day5/index.html#retro">Retro</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
    <label for="q" class="searchLabel">Search</label>
    <input type="text" name="q" class="form-control" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Refactor to Allow for New Data!</a><ul>
<li><a class="reference internal" href="#download-new-data">Download New Data</a></li>
<li><a class="reference internal" href="#understand-new-data">Understand New Data</a></li>
<li><a class="reference internal" href="#setup-postgis-container">Setup POSTGIS Container</a></li>
<li><a class="reference internal" href="#amend-classes-to-match-data">Amend Classes to Match Data</a></li>
<li><a class="reference internal" href="#use-hibernate-to-create-tables">Use Hibernate to Create Tables</a></li>
<li><a class="reference internal" href="#amend-import-sql-to-populate-tables">Amend import.sql to Populate Tables</a></li>
<li><a class="reference internal" href="#check-our-database-for-records">Check our Database for Records</a></li>
<li><a class="reference internal" href="#fix-broken-tests">Fix Broken Tests</a></li>
<li><a class="reference internal" href="#closing-remarks-next-steps">Closing remarks &amp; next steps</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="refactor-to-allow-for-new-data">
<span id="week4-new-data"></span><h1>Refactor to Allow for New Data!<a class="headerlink" href="#refactor-to-allow-for-new-data" title="Permalink to this headline">¶</a></h1>
<p>The underlying data for our web application has changed, and we have new requirements!</p>
<p>The first thing we need to do before working on our new features, is to get our new data, understand, and make changes to our web application, and data stores to allow for this new change in data.</p>
<dl class="docutils">
<dt>Tasks</dt>
<dd><ul class="first last simple">
<li>Download new data</li>
<li>Understand new data</li>
<li>Setup our PostGIS container</li>
<li>Amend our classes to match data</li>
<li>Use Hibernate to create tables</li>
<li>Amend import.sql to populate the new tables</li>
<li>Check our database for records</li>
</ul>
</dd>
</dl>
<div class="section" id="download-new-data">
<h2>Download New Data<a class="headerlink" href="#download-new-data" title="Permalink to this headline">¶</a></h2>
<p>You can find our new data in the <a class="reference external" href="https://gitlab.com/LaunchCodeTraining/zika-data/tree/week4" target="_blank">week4 branch of the zika-data<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> repository we used last week.</p>
<p>We recommend overwriting the CSV files you currently have in your zika-data folder in your project with these new files. Don’t worry, you won’t lose the old files because they are still recorded in your remote repository (GitLab)!</p>
</div>
<div class="section" id="understand-new-data">
<h2>Understand New Data<a class="headerlink" href="#understand-new-data" title="Permalink to this headline">¶</a></h2>
<p>Whenever you have a change in data you should always try to understand the changes, and how it will affect your project. We may need to change things, delete thing, add new things just to accomidate a change in data. Outlining these changes is a great way to keep yourself organized as you work to incorporate the changes.</p>
<p>The first thing that jumps out is that we no longer have CSV files for each Country, but instead have all of our Zika report data in one CSV file called <code class="docutils literal notranslate"><span class="pre">all_reports.csv</span></code>. We will eventually have to change our <code class="docutils literal notranslate"><span class="pre">import.sql</span></code> file since we no longer are reading from 5 different CSVs for our report data.</p>
<p>You will also notice that we have a <code class="docutils literal notranslate"><span class="pre">locations.csv</span></code> file, and instead of using geopoints, we are using multipolygons! Instead of representing a zika record as a point, we will now represent a zika record in a state within a country. The multipolygons represent states/provinces/territories of various countries. Our report data, and our location data are in separate files, and will live in separate tables of our database. We will have to join the report data with our location data in order to display them on our map. We will eventually have to change code in our controller files to combine this information when the <code class="docutils literal notranslate"><span class="pre">script.js</span></code> file requests GEOJSON.</p>
<p>Before we can change the files that load this data, we will need to make sure our database, underlying classes, and sql files are ready for this change in data!</p>
</div>
<div class="section" id="setup-postgis-container">
<h2>Setup POSTGIS Container<a class="headerlink" href="#setup-postgis-container" title="Permalink to this headline">¶</a></h2>
<p>One of the many benefits of using a containerization tool like Docker is we can easily control our containers. We currently have a PostGIS container for airwaze, and the zika project we worked on in week2. Instead of using the same container from week 2 we are going to setup a new PostGIS container for week4. This allows us to move quickly between different versions of our project. If you ever want to go back and see week2 in action you can simply turn off the week4 container, and turn on the week2 container.</p>
<p>However, our operating system will only allow one application to listen on one port at a time, so we first need to turn off any containers that are currently listening on port 5432.</p>
<p>From your terminal run <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">docker</span> <span class="pre">ps</span></code> to check which containers are currently running.</p>
<p>If you have any containers running go ahead and turn them off. You can do that by running <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">[CONTAINER_NAME</span> <span class="pre">or</span> <span class="pre">CONTAINER_ID]</span></code> from your terminal.</p>
<p>Now we want to create a new container with PostGIS. We’ve done this a couple of times throughout this class, but it’s always nice to have a reminder. Look over <a class="reference internal" href="../../installations/docker-postgis/index.html#docker-postgis"><span class="std std-ref">Docker Installation: PostGIS</span></a> for assistance.</p>
<p>Like last week you will need to create 2 databases, and 2 users for your databases.</p>
</div>
<div class="section" id="amend-classes-to-match-data">
<h2>Amend Classes to Match Data<a class="headerlink" href="#amend-classes-to-match-data" title="Permalink to this headline">¶</a></h2>
<p>Now that we have a shiny new PostGIS database, we need to amend and create our classes to match our data.</p>
<p>From last week we have a Report class already, but it doesn’t quite match our new data. You will need to amend the <code class="docutils literal notranslate"><span class="pre">Report.java</span></code> class so that it matches the reports in <code class="docutils literal notranslate"><span class="pre">all_reports.csv</span></code>. You will need to remove anything about Geometries, and you may need to remove more.</p>
<p>We will also need to create a new Location class. Create a new class called <code class="docutils literal notranslate"><span class="pre">Location.java</span></code> in your models directory. The properties of this class should match the headers of the <code class="docutils literal notranslate"><span class="pre">locations.csv</span></code> file.</p>
</div>
<div class="section" id="use-hibernate-to-create-tables">
<h2>Use Hibernate to Create Tables<a class="headerlink" href="#use-hibernate-to-create-tables" title="Permalink to this headline">¶</a></h2>
<p>We now want Hibernate to create tables in our database to match our Report class, and Location class.</p>
<p>We don’t want to load anything in to our tables yet, we just want to create the tables. So you will need to delete, or comment out your <code class="docutils literal notranslate"><span class="pre">import.sql</span></code>. You can comment out lines in SQL by adding <code class="docutils literal notranslate"><span class="pre">--</span></code> before the line. Comment out, or clear all the lines now.</p>
<p>Check your <code class="docutils literal notranslate"><span class="pre">application.properties</span></code> file for the <code class="docutils literal notranslate"><span class="pre">spring.jpa.hibernate.ddl-auto</span></code> option. What do you need to set this variable to to have Hibernate create our tables for us?</p>
<p>After setting <code class="docutils literal notranslate"><span class="pre">spring.jpa.hibernate.ddl-auto</span></code> to an appropriate value run your project with <code class="docutils literal notranslate"><span class="pre">bootRun</span></code>. You should see the Tomcat logs spit out some lines about creating new the new tables.</p>
<p>It would be a good idea to login to your PostGIS container, and check that the two tables were created correctly.</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">If you get an error when you run bootRun it is probably because one of your controllers calls the <code class="docutils literal notranslate"><span class="pre">.getGeom()</span></code> method which no longer exists after we changed our <code class="docutils literal notranslate"><span class="pre">Report.java</span></code> class. Comment out, or remove this code for now. We will come back to it later. You may also have other errors, work through them by following the code, and working with fellow classmates.</p>
</div>
</div>
<div class="section" id="amend-import-sql-to-populate-tables">
<h2>Amend import.sql to Populate Tables<a class="headerlink" href="#amend-import-sql-to-populate-tables" title="Permalink to this headline">¶</a></h2>
<p>Now that we have our database setup correctly we need to change the <code class="docutils literal notranslate"><span class="pre">import.sql</span></code> file.</p>
<p>Like last week we will need to use <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">docker</span> <span class="pre">cp</span></code> to copy our CSV files to our docker container.</p>
<p>From last week this file is loading from the 5 CSV files into 1 table. Now we want to load from 2 CSV files into 2 different tables. Similar to last week you will have to match up the CSV headers to the columns in the table.</p>
<div class="admonition">
<p class="first admonition-title"><i class="fas fa-sticky-note" aria-hidden="true"></i>Note</p>
<p class="last">Don’t forget about <code class="docutils literal notranslate"><span class="pre">spring.jpa.hibernate.ddl-auto</span></code> inside your <code class="docutils literal notranslate"><span class="pre">application.properties</span></code> file! If you don’t have that property set correctly, the <code class="docutils literal notranslate"><span class="pre">import.sql</span></code> file won’t run!</p>
</div>
<p>At the bottom of this file before <code class="docutils literal notranslate"><span class="pre">COMMIT;</span></code> add 3 additional lines.</p>
<p>These three lines load the unaccent extension to PostGIS, and then normalize the Country name, and State name of each report. Unaccent removes any diactrics, or symbols from letters. This will make our searches more effective in later objectives.</p>
</div>
<div class="section" id="check-our-database-for-records">
<h2>Check our Database for Records<a class="headerlink" href="#check-our-database-for-records" title="Permalink to this headline">¶</a></h2>
<p>After you amend <code class="docutils literal notranslate"><span class="pre">import.sql</span></code> re-run your project with <code class="docutils literal notranslate"><span class="pre">bootRun</span></code> make sure the Tomcat log is free of errors, and then log back into PostGIS from the command line and count the number of records in each table. We are expecting 250 location records, and 240,272 report records.</p>
<p>You can count the number of records from inside PostGIS with <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">COUNT(*)</span> <span class="pre">FROM</span> <span class="pre">report;</span></code> and <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">COUNT(*)</span> <span class="pre">FROM</span> <span class="pre">location;</span></code>.</p>
</div>
<div class="section" id="fix-broken-tests">
<h2>Fix Broken Tests<a class="headerlink" href="#fix-broken-tests" title="Permalink to this headline">¶</a></h2>
<p>Since our data has changed, and how our application handles the data has changed our tests are no longer correct.</p>
<p>Once you get to this point we should run our tests. Make sure to update your <code class="docutils literal notranslate"><span class="pre">application-test.properties</span></code> and <code class="docutils literal notranslate"><span class="pre">import-test.sql</span></code> files and then run your tests. You will notice that a large number of them fail. Since we have changed how our application handles the data, most of our tests are obsolete and will need to be refactored, or scrapped and re-written.</p>
<p>Run your tests, and either fix, or delete them. If you delete them you will need to create new tests later as you work through the remaining objectives.</p>
</div>
<div class="section" id="closing-remarks-next-steps">
<h2>Closing remarks &amp; next steps<a class="headerlink" href="#closing-remarks-next-steps" title="Permalink to this headline">¶</a></h2>
<p>Congrats! We now have a new database with 2 tables, report, and location. We have also updated the classes of our spring application to match, and we populated our new tables with the correct records. We have updated our database, and the models of our project. We still have a lot of work to do, but we have passed a significant step for this week!</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../../_sources/week04/new-data/index.rst.txt"
     rel="nofollow">Page Source</a>
</div>
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>