:orphan:

.. _postgres-walkthrough:

=======================
Walkthrough: PostgreSQL
=======================

Setup
-----

* Check that you have postgres installed by typing ``$ postgres --version`` into your terminal
* Check that you have docker installed by typing ``$ docker --version``
* Check that you have a running docker container for psql by typing ``$ docker ps -a``

If you are missing any of the three things above please fix them before we continue with the walkthrough.

* `Postgres installation steps <../../installations/postgres/>`_
* `Docker installation steps <../../installations/docker/>`_
* `Creating a PSQL docker container <../../installations/docker-psql/>`_

Let's Run Some Postgres Commands
--------------------------------

* Connect to PSQL interactive terminal ``psql -h IP_ADDRESS -p PORT -U USER_NAME -d DATABASE_NAME``

Create a Database
+++++++++++++++++

* ``CREATE DATABASE sports;``
* ``\l`` -- command to list all databases
* ``\c sports`` -- command to connect to the new sports database

Create a Schema
+++++++++++++++

* ``CREATE SCHEMA baseball;``
* ``\dn`` -- command to list all schemas

Create a Table
++++++++++++++

* ``CREATE TABLE baseball.teams (name varchar(50), league varchar(25), division varchar(25));`` -- create a new table on the baseball schema with three columns: name, league, and division
* ``\dt baseball.*;`` -- command to list all tables on the baseball schema

Insert Into
+++++++++++

* ``INSERT INTO TABLE baseball.teams(name, league, division) VALUES ('St. Louis Cardinals', 'National', 'Central');``
* ``SELECT * FROM baseball.teams;``

We can insert as many records as we want with one INSERT INTO statement.

* ``INSERT INTO TABLE baseball.teams(name, league, division) VALUES ('Washington Nationals', 'National', 'East'), ('Chicago Cubs', 'National', 'Central'), ('New York Mets', 'National', 'East'), ('New York Yankees', 'American', 'East');``

Select
++++++

* ``SELECT * FROM baseball.teams;`` -- SELECT all the columns from all the teams
* ``SELECT name FROM baseball.teams;`` -- SELECT only the name column from all the teams
* ``SELECT * FROM baseball.teams WHERE league='National';`` -- SELECT all the columns from all the teams in the 'National' league
* ``SELECT name, division FROM baseball.teams WHERE league='National';`` -- SELECT only the name, and division columns from teams in the 'National' league
* ``SELECT * FROM baseball.teams WHERE division='East' AND league='National';`` -- SELECT all the columns from all the teams in the 'East' division, that also are in the 'National' league

ALTER TABLE
+++++++++++




* Open Postgres.app on your mac
* In the postgres terminal we will run the following commands
* ``Create database sports;``
* ``\l`` shows list of databases
* ``create schema baseball;``
* ``Create table baseball.teams (name varchar(50), description varchar(100));``
* ``\d baseball.teams`` - show info about table

Now For Some SQL Queries
------------------------
* Insert
* Select
* delete* ``SELECT name FROM baseball.teams WHERE league='National';``
* Alter table

  * ALTER TABLE baseball.teams ADD COLUMN id integer PRIMARY KEY;

* Constraints

  * Not null
  * Primary key
  * Foreign key

* Create a Sequence

  * CREATE SEQUENCE baseball.teams_id_seq START 10;
  * DEFAULT nextval('baseball.teams_id_seq');

* Indexes

  * Created automatically with Primary Key and Unique constraints
  * You can also add an index manually
